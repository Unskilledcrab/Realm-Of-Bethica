function recalculateAll(){strength=parseInt($("#strength").val());fortitude=parseInt($("#fortitude").val());dexterity=parseInt($("#dexterity").val());accuracy=parseInt($("#accuracy").val());intellect=parseInt($("#intellect").val());resolve=parseInt($("#resolve").val());influence=parseInt($("#influence").val());demeanor=parseInt($("#demeanor").val());setValues("strength",strength);setValues("fortitude",fortitude);setValues("dexterity",dexterity);setValues("accuracy",accuracy);setValues("intellect",intellect);setValues("resolve",resolve);setValues("influence",influence);setValues("demeanor",demeanor);level=parseInt($("#level").val());setDeadlift();setBenchPress();setCarryingCapacity();setStrengthDamage();setStrengthSave();setFortitudeSave();setResolveSave();setEvasion();setDodge();setReaction();setMana();setDivinePower();setAllVital();setAllParentSkills();setVision();setListen();setSmell()}function setAllVital(){setBasePoints();setOP_DTH();setMHP();setHPB();setHP()}function setAllParentSkills(){setAtrisan();setAthletics();setAwareness();setKnowledge();setNature();setSocial();setSubterfuge();setMelee();setRange()}function setValues(n,t){var r=parseInt(t,10),u=getModiferValue(n),i=r+u;$("#"+n).val(i);$("#"+n+"Display").text(i)}function addValue(n,t){var i=parseInt($("#"+n).val(),10),r=i+t;setValues(n,r)}function getDisplayValue(n){return parseInt($("#"+n+"Display").text(),10)}function getModiferValue(n){var t=parseInt($("#"+n+"Modifier").val(),10);return isNaN(t)&&(t=0),t}function setListen(){setValues("listen",getDisplayValue("awareness"))}function setVision(){setValues("vision",getDisplayValue("awareness"))}function setSmell(){setValues("smell",getDisplayValue("awareness"))}function setAtrisan(){var n="artisan";setValues(n,getParentSkill(dexterity,intellect,n))}function setAthletics(){var n="athletics";setValues(n,getParentSkill(strength,dexterity,n))}function setAwareness(){var n="awareness";setValues(n,getParentSkill(intellect,resolve,n))}function setKnowledge(){var n="knowledge";setValues(n,getParentSkill(intellect,resolve,n))}function setNature(){var n="nature";setValues(n,getParentSkill(intellect,resolve,n))}function setSocial(){var n="social";setValues(n,getParentSkill(influence,demeanor,n))}function setSubterfuge(){var n="subterfuge";setValues(n,getParentSkill(dexterity,intellect,n))}function setMelee(){var n="melee";setValues(n,getParentSkill(strength,dexterity,n))}function setRange(){var n="range";setValues(n,getParentSkill(accuracy,intellect,n))}function getDeadlift(){return Math.ceil(strength*30)}function setDeadlift(){setValues("deadlift",getDeadlift())}function getBenchPress(){return Math.ceil(strength*20)}function setBenchPress(){setValues("benchpress",getBenchPress())}function getCarryingCapacity(){return Math.ceil(strength*10)}function setCarryingCapacity(){setValues("carryingcapacity",getCarryingCapacity())}function getStrengthDamage(){return Math.ceil(strength/2)}function setStrengthDamage(){setValues("strengthdamage",getStrengthDamage())}function getStrengthSave(){return Math.ceil(strength+level)}function setStrengthSave(){setValues("strengthsave",getStrengthSave())}function getFortitudeSave(){return Math.ceil(fortitude+level)}function setFortitudeSave(){setValues("fortitudesave",getFortitudeSave())}function getResolveSave(){return Math.ceil(resolve+level)}function setResolveSave(){setValues("resolvesave",getResolveSave())}function getEvasion(){return Math.ceil(dexterity+10+level)}function setEvasion(){setValues("evasion",getEvasion())}function getDodge(){return Math.ceil(getEvasion()+10)}function setDodge(){setValues("dodge",getDodge())}function getReaction(){return Math.ceil(dexterity+intellect/2)}function setReaction(){setValues("reaction",getReaction())}function getMana(){return Math.ceil(resolve+resolve/2*level)}function setMana(){setValues("mana",getMana())}function getDivinePower(){return Math.ceil(influence/2+level)}function setDivinePower(){setValues("divinepower",getDivinePower())}function getBasePoints(){return Math.ceil(fortitude*2)}function setBasePoints(){setValues("bp",getBasePoints());setValues("cp",getBasePoints());setValues("fp",getBasePoints())}function getOP_DTH(){return Math.ceil(fortitude)}function setOP_DTH(){setValues("op",getOP_DTH());setValues("dth",getOP_DTH())}function getMHP(){return Math.ceil(resolve*4)}function setMHP(){setValues("mhp",getMHP())}function getHPB(){return Math.ceil(1+fortitude/5)}function setHPB(){setValues("hpb",getHPB())}function getHP(){return Math.ceil(strength+fortitude+getHPB(fortitude))}function setHP(){setValues("hp",getHP())}function getParentSkill(n,t,i){var r=0;return $("#"+i+"Proficient").prop("checked")==!0&&(r=2),Math.ceil((n+t)/2+r)}var SheetRepoBase,sheetId,SheetRepo;$(document).ready(function(){recalculateAll()});SheetRepoBase=function(n,t){this.uri=window.location.origin+"/api/"+n+"/"+t;this.endpoint=t;this.allData=[];this.data=null};SheetRepoBase.prototype.getAllDataAsync=function(){var n=this;$.ajax({url:n.uri,type:"GET",success:function(t){n.allData=t;console.log("successfully retrieved "+n.endpoint);console.log(t)},error:function(t){console.log("error occured retrieved "+n.endpoint);console.log(t.responseText)}})};SheetRepoBase.prototype.getDataAsync=function(n){var t=this;$.ajax({url:t.uri+"/"+n,type:"GET",success:function(i){t.data=i;console.log("successfully retrieved "+t.endpoint+" "+n);console.log(i)},error:function(i){console.log("error occured retrieved "+t.endpoint+" "+n);console.log(i.responseText)}})};SheetRepoBase.prototype.addDataAsync=function(n){var t=this;$.ajax({url:t.uri,type:"POST",data:JSON.stringify(n),contentType:"application/json;charset=UTF-8",cache:!1,success:function(n){console.log("successfully added "+t.endpoint+" "+n);console.log(n)},error:function(i){console.log("error occured adding "+t.endpoint+" "+n);console.log(i.responseText)}})};SheetRepoBase.prototype.updateDataAsync=function(n){var t=this;$.ajax({url:t.uri,type:"PUT",data:JSON.stringify(n),contentType:"application/json;charset=UTF-8",cache:!1,success:function(n){console.log("successfully added "+t.endpoint+" "+n);console.log(n)},error:function(i){console.log("error occured adding "+t.endpoint+" "+n);console.log(i.responseText)}})};SheetRepoBase.prototype.deleteDataAsync=function(n){var t=this;$.ajax({url:t.uri+"/"+n,type:"DELETE",success:function(i){console.log("successfully deleted "+t.endpoint+" "+n);console.log(i)},error:function(i){console.log("error occured deleting "+t.endpoint+" "+n);console.log(i.responseText)}})};sheetId=$("#sheetId").attr("data-id");SheetRepo=function(n){SheetRepoBase.call(this,sheetId,n)};SheetRepo.prototype=Object.create(SheetRepoBase.prototype);var weapons=new SheetRepo("CharacterWeaponsManager"),items=new SheetRepo("CharacterItemsManager"),shields=new SheetRepo("CharacterShieldsManager"),notes=new SheetRepo("CharacterNotesManager"),details=new SheetRepo("CharacterDetailsManager"),testNotes={PublicNotes:"notes",PrivateNotes:"pnotes",Backstory:"backstory"},testDetails={Background:"notes",Gender:"pnotes",EyeColor:"backstory"},CalculationBase=function(){this.setup=function(){this.calcs=[];$.each($("[data-expression]"),function(){var t=$(this).attr("data-variable"),u=$(this).attr("data-priority"),n,i,r;window[t]=0;n={priority:parseInt(u)};sheetCalculations.addUpdateFunction(t,n);i=$(this).attr("data-expression");r=$(this).attr("data-expression-enabled");r?sheetCalculations.addCalculation(i,n):sheetCalculations.addCalculation("console.log('function disabled')",n);sheetCalculations.calcs.push(n)});this.calcs.sort(function(n,t){return n.priority-t.priority})};this.addCalculation=function(n,t){t.calculationFunction=function(){return Function('"use strict";return ('+n+")")()}};this.addUpdateFunction=function(n,t){t.updateFunction=function(){var t=$("[data-variable="+n+"]");t.val(window[n]);t.text(window[n])}};this.runCalculations=function(){for(var n=0;n<this.calcs.length;n++)this.calcs[n].calculationFunction()};this.runUpdates=function(){for(var n=0;n<this.calcs.length;n++)this.calcs[n].updateFunction()};this.run=function(){this.runCalculations();this.runUpdates()}},sheetCalculations=new CalculationBase;